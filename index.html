<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>El Cuervo Turrán</title>
  <style>
    body { margin:0; background:#111; overflow:hidden; }
    canvas { display:block; margin:auto; background:#87ceeb; }
    #controls {
      position:fixed; bottom:20px; left:0; right:0;
      display:flex; justify-content:center; gap:20px;
    }
    button {
      width:60px; height:60px; border:none;
      border-radius:10px; font-size:24px;
    }
    #left,#right { background:#333; color:white; }
    #jump { background:#007bff; color:white; }
    #score {
      position:fixed; top:10px; left:10px;
      font-size:20px; color:white; font-family:sans-serif;
    }
  </style>
</head>
<body>
  <div id="score">Puntos: 0</div>
  <canvas id="game" width="480" height="270"></canvas>
  <div id="controls">
    <button id="left">◄</button>
    <button id="jump">⤒</button>
    <button id="right">►</button>
  </div>
<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let keys={left:false,right:false,jump:false};
document.getElementById("left").ontouchstart=()=>keys.left=true;
document.getElementById("left").ontouchend=()=>keys.left=false;
document.getElementById("right").ontouchstart=()=>keys.right=true;
document.getElementById("right").ontouchend=()=>keys.right=false;
document.getElementById("jump").ontouchstart=()=>keys.jump=true;
document.getElementById("jump").ontouchend=()=>keys.jump=false;
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft") keys.left=true;
  if(e.key==="ArrowRight") keys.right=true;
  if(e.key==="ArrowUp") keys.jump=true;
});
document.addEventListener("keyup",e=>{
  if(e.key==="ArrowLeft") keys.left=false;
  if(e.key==="ArrowRight") keys.right=false;
  if(e.key==="ArrowUp") keys.jump=false;
});

// personaje
const player={x:50,y:200,w:32,h:32,vy:0,onGround:false,score:0,life:3};
const gravity=0.8;
const ground=240;

// enemigos
let enemies=[];

// sprites
const img=new Image();
img.src="turran_sprite.png";

function spawnEnemy(){
  enemies.push({x:canvas.width+50,y:ground-32,w:32,h:32});
}
setInterval(spawnEnemy,3000);

// bucle
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // suelo
  ctx.fillStyle="#228B22";
  ctx.fillRect(0,ground,canvas.width,canvas.height-ground);

  // control jugador
  if(keys.left) player.x-=3;
  if(keys.right) player.x+=3;
  if(keys.jump && player.onGround){
    player.vy=-12; player.onGround=false;
    // bocadillo
    ctx.fillStyle="white";
    ctx.fillRect(player.x-10,player.y-30,80,20);
    ctx.fillStyle="black";
    ctx.fillText("PARAPARAA!!",player.x-5,player.y-15);
  }

  player.vy+=gravity;
  player.y+=player.vy;
  if(player.y+player.h>=ground){
    player.y=ground-player.h;
    player.vy=0;
    player.onGround=true;
  }

  // dibujar jugador
  ctx.drawImage(img,0,0,32,32,player.x,player.y,32,32);

  // enemigos
  ctx.fillStyle="red";
  for(let i=0;i<enemies.length;i++){
    let en=enemies[i];
    en.x-=2;
    ctx.fillRect(en.x,en.y,en.w,en.h);

    // colisión
    if(player.x<en.x+en.w && player.x+player.w>en.x &&
       player.y<en.y+en.h && player.y+player.h>en.y){
      if(player.vy>0){ // cae encima
        enemies.splice(i,1); i--;
        player.score+=10;
      }else{ // golpe
        player.life--;
        if(player.life<=0){
          alert("GAME OVER");
          player.score=0; player.life=3;
        }
      }
    }
  }

  // marcador
  document.getElementById("score").innerText="Puntos: "+player.score+" | Vidas: "+player.life;

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
